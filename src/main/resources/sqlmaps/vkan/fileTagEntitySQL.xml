<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaoshabao.vkan.entity.FileTagEntity">
	<insert id="insertTagByParentId">
		insert into vk_file_tag
		(id,file_id,tag_id)
		select null,a.file_id,#{tagId}
		from vk_file a where a.parent_id=#{parentId}
	</insert>
	<insert id="insertTagById">
		insert into vk_file_tag
		(id,file_id,tag_id)
		select null,a.file_id,#{tagId}
		from vk_file a where a.file_id=#{fileId}
	</insert>
	
	<!-- 删除 -->
	<delete id="deleteFileTagEntity">
	  delete from vk_file_tag
	  <where>
	  	<!-- 如果没传入参数 不更新 -->
	  	<if test="fileId ==null and parentId ==null">
			and 1=2,
		</if>
	  	<if test="fileId !=null">
			and file_id=#{fileId},
		</if>
		<if test="parentId !=null">
			and parent_id=#{parentId},
		</if>
		<if test="tagId !=null">
			and tag_id=#{tagId},
		</if>
	  </where>
	</delete>

</mapper>